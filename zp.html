<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞—Ä–ø–ª–∞—Ç–∏</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f4f6;
      padding: 20px;
      color: #222;
    }
    .container {
      max-width: 420px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: 600;
    }
    input {
      width: 100%;
      padding: 8px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 4px;
    }
    .sum-line {
      font-size: 0.9rem;
      color: rgba(0,0,0,0.6);
      text-align: right;
      margin-top: -0.3rem;
      margin-bottom: 0.5rem;
    }
    #total {
      margin-top: 20px;
      font-size: 1.2rem;
      font-weight: bold;
      text-align: center;
      color: #111;
    }
    button {
      width: 100%;
      margin-top: 10px;
      padding: 10px;
      font-size: 16px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }
    #reset { background: #ddd; }
    #reset:hover { background: #ccc; }
    #share { background: #0088cc; color: white; }
    #share:hover { background: #0077b6; }
    #toggleNovachky {
      margin-right: 6px;
    }
    .toggle-line {
      margin-top: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
    }
    .back-btn {
      background: #eee;
      color: #333;
      font-size: 14px;
      width: auto;
      padding: 6px 12px;
      margin-bottom: 10px;
    }
    #hoursContainer {
      display: none;
    }
  </style>
</head>
<body>
  <button class="back-btn" onclick="window.location.href='index.html'">‚¨Ö –ù–∞–∑–∞–¥ –¥–æ –º–µ–Ω—é</button>

  <div class="container">
    <h2>–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞—Ä–ø–ª–∞—Ç–∏</h2>

    <label id="labelDs">üì¶ –ó–±–∏—Ä–∞–Ω–Ω—è –≤ –î–° (1,34 –≥—Ä–Ω):</label>
    <input type="number" id="ds">
    <div id="sumDs" class="sum-line"></div>

    <label id="labelTz">üõí –ó–±–∏—Ä–∞–Ω–Ω—è –≤ –¢–ó (2,69 –≥—Ä–Ω):</label>
    <input type="number" id="tz">
    <div id="sumTz" class="sum-line"></div>

    <label id="labelMove">üîÅ –ü–µ—Ä–µ–º—ñ—â–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤ –∑ –¢–ó (3,32 –≥—Ä–Ω):</label>
    <input type="number" id="move">
    <div id="sumMove" class="sum-line"></div>

    <label id="labelPlace">üì• –†–æ–∑–º—ñ—â–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤ —É –î–° (1,53 –≥—Ä–Ω):</label>
    <input type="number" id="place">
    <div id="sumPlace" class="sum-line"></div>

    <label id="labelWeight">‚öñÔ∏è –í–∞–≥–∞ —Ä–æ–∑–º—ñ—â–µ–Ω–Ω—è (0,14 –≥—Ä–Ω):</label>
    <input type="number" id="weight">
    <div id="sumWeight" class="sum-line"></div>

    <label id="labelPack">üéÅ –ü–∞–∫—É–≤–∞–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (0,27 –≥—Ä–Ω):</label>
    <input type="number" id="pack">
    <div id="sumPack" class="sum-line"></div>

    <div class="toggle-line">
      <input type="checkbox" id="toggleNovachky">
      <label for="toggleNovachky">–†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥–ª—è –Ω–æ–≤–∞—á–∫—ñ–≤</label>
    </div>

    <div id="hoursContainer">
      <label>‚è±Ô∏è –ì–æ–¥–∏–Ω–∏ —Ä–æ–±–æ—Ç–∏ (46.72 –≥—Ä–Ω/–≥–æ–¥):</label>
      <input type="number" id="hours">
    </div>

    <div id="total">–í—Å—å–æ–≥–æ: 0.00 –≥—Ä–Ω</div>

    <button id="reset">üîÑ –û—á–∏—Å—Ç–∏—Ç–∏</button>
    <button id="share">üì§ –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –≤ Telegram</button>
  </div>

  <script>
    const baseRates={ds:1.34,tz:2.69,move:3.32,place:1.53,weight:0.14,pack:0.27};
    const newRates={ds:0.67,tz:1.34,move:1.66,place:0.76,weight:0.07,pack:0.14};
    let rates={...baseRates};
    const hourlyRate=46.72;

    const ds=document.getElementById('ds'),
          tz=document.getElementById('tz'),
          move=document.getElementById('move'),
          place=document.getElementById('place'),
          weight=document.getElementById('weight'),
          pack=document.getElementById('pack'),
          hours=document.getElementById('hours'),
          total=document.getElementById('total'),
          reset=document.getElementById('reset'),
          share=document.getElementById('share'),
          toggle=document.getElementById('toggleNovachky'),
          hoursContainer=document.getElementById('hoursContainer');

    const sumElems={
      ds:document.getElementById('sumDs'),
      tz:document.getElementById('sumTz'),
      move:document.getElementById('sumMove'),
      place:document.getElementById('sumPlace'),
      weight:document.getElementById('sumWeight'),
      pack:document.getElementById('sumPack')
    };

    let manualPack = false; // –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ä—É—á–Ω—É—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–ª "–ü–∞–∫—É–≤–∞–Ω–Ω—è"

    // ===== –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ—Å—á—ë—Ç–∞ =====
    function updateTotal(){
      if(!manualPack){
        pack.value = Number(ds.value||0) + Number(tz.value||0);
      }

      const sums = {
        ds: rates.ds * Number(ds.value||0),
        tz: rates.tz * Number(tz.value||0),
        move: rates.move * Number(move.value||0),
        place: rates.place * Number(place.value||0),
        weight: rates.weight * Number(weight.value||0),
        pack: rates.pack * Number(pack.value||0),
        hours: Number(hours.value||0) * hourlyRate
      };

      sumElems.ds.textContent = sums.ds ? `= ${sums.ds.toFixed(2)} –≥—Ä–Ω` : '';
      sumElems.tz.textContent = sums.tz ? `= ${sums.tz.toFixed(2)} –≥—Ä–Ω` : '';
      sumElems.move.textContent = sums.move ? `= ${sums.move.toFixed(2)} –≥—Ä–Ω` : '';
      sumElems.place.textContent = sums.place ? `= ${sums.place.toFixed(2)} –≥—Ä–Ω` : '';
      sumElems.weight.textContent = sums.weight ? `= ${sums.weight.toFixed(2)} –≥—Ä–Ω` : '';
      sumElems.pack.textContent = sums.pack ? `= ${sums.pack.toFixed(2)} –≥—Ä–Ω` : '';

      const totalSum = Object.values(sums).reduce((a,b)=>a+b,0);
      total.textContent = `–í—Å—å–æ–≥–æ: ${totalSum.toFixed(2)} –≥—Ä–Ω`;
    }

    // ===== –°–æ–±—ã—Ç–∏—è =====
    [ds,tz,move,place,weight,pack,hours].forEach(i=>{
      i.addEventListener('input',updateTotal);
    });

    pack.addEventListener('input',()=>{
      manualPack = true;
      updateTotal();
    });

    pack.addEventListener('focus',()=>{
      if(pack.value===''){
        manualPack = false;
        updateTotal();
      }
    });

    toggle.addEventListener('change',()=>{
      if(toggle.checked){
        hoursContainer.style.display='block';
        rates={...newRates};
      } else {
        hoursContainer.style.display='none';
        hours.value='';
        rates={...baseRates};
      }
      updateTotal();
    });

    reset.addEventListener('click',()=>{
      [ds,tz,move,place,weight,pack,hours].forEach(i=>i.value='');
      manualPack=false;
      updateTotal();
    });

    share.addEventListener('click',()=>{
      const today=new Date();
      const d=today.getDate().toString().padStart(2,'0'),
            m=(today.getMonth()+1).toString().padStart(2,'0'),
            y=today.getFullYear();
      const text=`–ú—ñ–π –∑–∞—Ä–æ–±—ñ—Ç–æ–∫ (${d}.${m}.${y}) ‚Äî ${total.textContent.split(': ')[1]}\n–ü–µ—Ä–µ–≤—ñ—Ä —Å–≤—ñ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç—É—Ç: https://perevershnik.github.io/zp/`;
      const url=`https://t.me/share/url?url=&text=${encodeURIComponent(text)}`;
      window.open(url,'_blank');
    });

    updateTotal(); // –Ω–∞—á–∞–ª—å–Ω—ã–π –ø–µ—Ä–µ—Å—á—ë—Ç
  </script>
</body>
</html>
